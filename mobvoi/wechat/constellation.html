<!DOCTYPE HTML>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <meta name="format-detection" content="telephone=no" />

  <title>出门问问 - 星座运势</title>
  <link rel="stylesheet" href="http://onebox.oss.aliyuncs.com/css/h5-layout.1.01.css" >
  <script src="http://onebox.oss.aliyuncs.com/js/zepto.1.0.min.js"></script>
  <script src="http://onebox.oss.aliyuncs.com/js/template.syntax.1.0.min.js"></script>
</head>

<body>
  <div class="wrapper">
  </div>
</body>
</html>

<script type="text/html" id="wrapper_constellation_date">
  <ul class="cards">
    <li class="cards_card result layout-444">
      <div class="cards_card_entire">
        <p><span>为您搜索到 “{ params[0].value }{ answer[0].content.cndate }运势” </span></p>
      </div>
    </li>  
    <li class="cards_img">
      <img src="{ answer[0].content.pic }" width="100%" />
    </li>
    <li class="cards_card layout-17px">
      <div class="cards_card_entire">
        <p><span>开运方向：{ answer[0].content.luckydirection }</span></p>
        <p><span>开运颜色：{ answer[0].content.luckycolor }</span></p>
        <p><span>健康状况指数：{ answer[0].content.healthfortune_score }</span></p>
        <p><span>今日幸运物：{ answer[0].content.luckystuff }</span></p>
      </div>
    </li>
    <li class="cards_card">
      <div class="cards_card_entire">
        <p><span class="layout-17px layout-orange">心情</span></p>
        <p><span>{ answer[0].content.moodfortune_score }分，{ answer[0].content.moodfortune }</span></p>
      </div>
    </li>
    <li class="cards_card">
      <div class="cards_card_entire">
        <p><span class="layout-17px layout-orange">爱情运势</span></p>
        <p><span>{ answer[0].content.lovefortune_score }分，{ answer[0].content.lovefortune }</span></p>
      </div>
    </li>
    <li class="cards_card">
      <div class="cards_card_entire">
        <p><span class="layout-17px layout-orange">财富运势</span></p>
        <p><span>{ answer[0].content.wealthfortune_score }分，{ answer[0].content.wealthfortune }</span></p>
      </div>
    </li>
    <li class="cards_card">
      <div class="cards_card_entire">
        <p><span class="layout-17px layout-orange">事业运势</span></p>
        <p><span>{ answer[0].content.workfortune_score }分，{ answer[0].content.workfortune }</span></p>
      </div>
    </li>   
  </ul>
</script>

<script type="text/html" id="wrapper_constellation_week">
  <ul class="cards">
    <li class="cards_card result layout-444">
      <div class="cards_card_entire">
        <p><span>为您搜索到 “{ params[0].value }{ answer[0].content.week }运势” </span></p>
      </div>
    </li>  
    <li class="cards_img">
      <img src="{ answer[0].content.pic }" width="100%" />
    </li>
    <li class="cards_card layout-17px">
      <div class="cards_card_entire">
        <p><span>本周财神：{ answer[0].content.wealther }</span></p>
        <p><span>本周来电情人：{ answer[0].content.lover }</span></p>
        <p><span>本周幸运日：{ answer[0].content.luckday }</span></p>
        <p><span>本周爱情幸运物：{ answer[0].content.luckystuff }</span></p>
      </div>
    </li>
    <li class="cards_card">
      <div class="cards_card_entire">
        <p><span class="layout-17px layout-orange">整体运势</span></p>
        <p><span>{ answer[0].content.allfortune }</span></p>
      </div>
    </li>
    <li class="cards_card">
      <div class="cards_card_entire">
        <p><span class="layout-17px layout-orange">爱情运势</span></p>
        <p><span>{ answer[0].content.lovefortune }</span></p>
      </div>
    </li>
    <li class="cards_card">
      <div class="cards_card_entire">
        <p><span class="layout-17px layout-orange">财富运势</span></p>
        <p><span>{ answer[0].content.wealthfortune }</span></p>
      </div>
    </li> 
  </ul>
</script>

<script type="text/html" id="wrapper_constellation_month">
  <ul class="cards">
    <li class="cards_card result layout-444">
      <div class="cards_card_entire">
        <p><span>为您搜索到 “{ params[0].value }{ answer[0].content.month }月运势” </span></p>
      </div>
    </li>  
    <li class="cards_img">
      <img src="{ answer[0].content.pic }" width="100%" />
    </li>
    <li class="cards_card layout-17px">
      <div class="cards_card_entire">
        <p><span>心情阳光指数：{ answer[0].content.happy_score }</span></p>
        <p><span>健康状况指数：{ answer[0].content.healthfortune_score }</span></p>
        <p><span>本月幸运贵人：{ answer[0].content.helper }</span></p>
        <p><span>本月防范小人：{ answer[0].content.badstar }</span></p>
        <p><span>让你头痛的星座：{ answer[0].content.villain }</span></p>
        <p><span>本月开运场所：{ answer[0].content.luckyplace }</span></p>
      </div>
    </li>
    <li class="cards_card">
      <div class="cards_card_entire">
        <p><span class="layout-17px layout-orange">整体运势</span></p>
        <p><span>{ answer[0].content.allfortune }</span></p>
      </div>
    </li>
    <li class="cards_card">
      <div class="cards_card_entire">
        <p><span class="layout-17px layout-orange">爱情运势</span></p>
        <p><span>{ answer[0].content.lovefortune }</span></p>
      </div>
    </li>
    <li class="cards_card">
      <div class="cards_card_entire">
        <p><span class="layout-17px layout-orange">财富运势</span></p>
        <p><span>{ answer[0].content.wealthfortune }</span></p>
      </div>
    </li> 
  </ul>
</script>

<script type="text/html" id="wrapper_constellation_wrong">
  <ul class="cards">
    <li class="cards_card result layout-444">
      <div class="cards_card_entire">
        <p><span>暂时还没有 “{ params[0].value }{ params[1].value }运势” 的信息</span></p>
      </div>
    </li>
  </ul>
</script>

<script>
  var response = {"session_id":"public.constellation@75f2093628f22af2b7cf7293cfb31575","location":{"street":"西藏南路","province":"上海市","lng":121.48479060028,"streetNumber":"2号","sublocality":"黄浦区","lat":31.234309729773,"city":"上海","country":"中国"},"status":"success","task":"public.constellation","query":"双子运势","remote_ip":"218.82.37.181","answer":[{"content":{"cndate":"2013年09月20日","lovefortune":"你身边的人会特别挂心你的爱情，说不定会给你安排相亲活动。","luckydirection":"西方","workfortune":"你的人脉资源将有助于手边的业务推动，只是善加利用是个很大的问题。","luckycolor":"咖啡色","moodfortune":"今天该是你发挥三寸不烂之舌的长处，有些人际沟通的事务让你一展身手。","pic":"http://mobvoi-one-box.oss.aliyuncs.com/wechat/constellation/astro_3.jpg","date":"2013-09-20","astro":"双子座","wealthfortune":"请朋友吃个饭表现你的大方！一点点小钱维系朋友感情很值得。","wealthfortune_score":"4","healthfortune_score":"3","workfortune_score":"3","moodfortune_score":"4","luckystuff":"桃木梳子","lovefortune_score":"5"},"status":200,"type":"date"}],"appkey":"wechat_chumenwenwen","location_option":{"content":"","is_need":false},"params":[{"value":"双子座","keyname":"星座","key":"constellation"},{"value":"2013-09-20","keyname":"日期","key":"time_val"}],"taskName":"查星座","version":"undefined","msg_id":"b77246af-6ef3-48b2-91b3-b87c9a693770","user_id":"undefined","query_type":"text"};

  switch (response.answer[0].type) {
    case "date":
    $(".wrapper").html(template.render("wrapper_constellation_date", response));
    break;
    case "week":
    $(".wrapper").html(template.render("wrapper_constellation_week", response));
    break;
    case "month":
    $(".wrapper").html(template.render("wrapper_constellation_month", response));
    break;
    case "wrong type":
    $(".wrapper").html(template.render("wrapper_constellation_wrong", response));
    break;        
  }

  // for share in wechat
  var dataForWeixin = {
    appId: "",
    MsgImg: response.answer[0].content.pic,
    TLImg: response.answer[0].content.pic,
    url: window.location.href,
    title: "出门问问 - 星座运势",
    desc: "我在出门问问找到了" + response.params[0].value + "的星座运势",
    fakeid: "",
  };
  var onBridgeReady = function () {
    WeixinJSBridge.on('menu:share:appmessage', function (argv) {
      WeixinJSBridge.invoke('sendAppMessage', {
        "appid": dataForWeixin.appId,
        "img_url": dataForWeixin.MsgImg,
        "img_width": "120",
        "img_height": "120",
        "link": dataForWeixin.url,
        "desc": dataForWeixin.desc,
        "title": dataForWeixin.title
      });
    });
    WeixinJSBridge.on('menu:share:timeline', function (argv) {
      WeixinJSBridge.invoke('shareTimeline', {
        "appid": dataForWeixin.appId,
        "img_url": dataForWeixin.TLImg,
        "img_width": "120",
        "img_height": "120",
        "link": dataForWeixin.url,
        "desc": dataForWeixin.desc,
        "title": dataForWeixin.title
      });
    });
  };
  if (document.addEventListener) {
    document.addEventListener('WeixinJSBridgeReady', onBridgeReady, false);
  } else if (document.attachEvent) {
    document.attachEvent('WeixinJSBridgeReady', onBridgeReady);
    document.attachEvent('onWeixinJSBridgeReady', onBridgeReady);
  }
</script>